---
# Preamble

## Author
author:
  name: Мишина Анастасия Алексеевна
  orcid: 0009-0002-6246-7100
  email: 1132226532@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Отчет по лабораторной работе №1"
subtitle: "Дисциплина: Моделирование сетей передачи данных"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Целью работы является развёртывание Mininet в системе виртуализации (VirtualBox), знакомство с основными командами для работы с Mininet через командную строку и через графический интерфейс.

# Теоретическое введение

Mininet [@mininet] -- это эмулятор компьютерной сети. Под компьютерной сетью подразумеваются простые компьютеры — хосты, коммутаторы, а так же OpenFlow-контроллеры. С помощью простейшего синтаксиса в примитивном интерпретаторе команд можно разворачивать сети из произвольного количества хостов, коммутаторов в различных топологиях и все это в рамках одной виртуальной машины (ВМ). На всех хостах можно изменять сетевую конфигурацию, пользоваться стандартными утилитами (ifconfig, ping) и даже получать доступ к терминалу. На коммутаторы можно добавлять различные правила и маршрутизировать трафик.

Mininet создает реалистичную виртуальную сеть, выполняя реальный код ядра, коммутатора и приложения на одной машине (VM, облачной или собственной) за считанные секунды с помощью одной команды `sudo mn`.

# Выполнение лабораторной работы

## Настройка образа VirtualBox

Перейдем в репозиторий Mininet, скачаем актуальный релиз ovf-образа виртуальной машины. Запустим систему виртуализации и импортируем файл .ovf и укажем параметры импорта.

Перейдем в настройки системы виртуализации и уточним параметры настройки виртуальной машины. В частности, для VirtualBox выберем импортированную виртуальную машину и перейдите в меню "Машина -> Настроить".

Перейдем к опции «Система». Если внизу этого окна есть сообщение об обнаружении неправильных настроек, то, следуя рекомендациям, внесем исправления (изменим тип графического контроллера на рекомендуемый) ([рис. @fig-001]).

![Исправление неправильных настроек](image/1.png){#fig-001 width=70%}

В настройках сети первый адаптер должен иметь подключение типа NAT ([рис. @fig-002]). Для второго адаптера укажем тип подключения host-only network adapter (виртуальный адаптер хоста), который в дальнейшем мы будем использовать для входа в образ виртуальной машины ([рис. @fig-003]).

![Настройка сети](image/2.png){#fig-002 width=70%}

![Настройка сети](image/3.png){#fig-003 width=70%}

## Подключение к виртуальной машине

Запустим виртуальную машину с Mininet.
Залогинимся в виртуальную машину:
- login: mininet
- password: mininet

Посмотрим адрес машины с помощью `ifconfig` ([рис. @fig-004]).

![Запуск mininet](image/4.png){#fig-004 width=70%}

Подключимся к виртуальной машине (из терминала хостовой машины) ([рис. @fig-005]).

![Подключение к ВМ с mininet через SSH](image/5.png){#fig-005 width=70%}

## Настройка доступа в Интернет

После подключения к виртуальной машине mininet посмотрим IP-адреса машины ([рис. @fig-006]). Активен только внутренний адрес машины вида 192.168.x.y, поэтому активируем второй интерфейс ([рис. @fig-007]).

![Просмотр IP-адресов машины](image/6.png){#fig-006 width=70%}

![Активация второго интерфейса](image/7.png){#fig-007 width=70%}

Для удобства дальнейшей работы добавим для mininet указание на использование двух адаптеров при запуске. Для этого требуется перейти в режим суперпользователя и внести изменения в файл /etc/netplan/01-netcfg.yaml виртуальной машины mininet. В результате файл /etc/netplan/01-netcfg.yaml должен иметь следующий вид  ([рис. @fig-008]).

![Файл /etc/netplan/01-netcfg.yaml](image/8.png){#fig-008 width=70%}

## Обновление версии Mininet

В виртуальной машине mininet переименуем предыдущую установку Mininet. Скачаем новую версию Mininet.
Обновим исполняемые файлы ([рис. @fig-009]).

![Обновление Mininet](image/9.png){#fig-009 width=70%}

Проверим номер установленной версии mininet ([рис. @fig-010]).

![Номер установленной версии mininet](image/10.png){#fig-010 width=70%}

## Настройка параметров XTerm

Настроим параметры XTerm для увеличения размера шрифта и применения векторных шрифтов вместо растровых. Внесем изменения в файл `/etc/X11/app-defaults/XTerm` ([рис. @fig-011]).

![Настройка шрифтов XTerm](image/11.png){#fig-011 width=70%}

## Работа с Mininet из-под Windows

Установим putty и VcXsrv Windows X Server (у меня уже были установлены). Запустим XLaunch.

Выберем опции:
- Multiple windows ([рис. @fig-012]);
- Display number: -1;
- Start no client ([рис. @fig-013]).


![Опции](image/12.png){#fig-012 width=70%}

![Опции](image/13.png){#fig-013 width=70%}

При подключении добавим опцию перенаправления X11: – Connection SSH X11 : Enable X11 forwarding ([рис. @fig-014]).

![Опция перенаправления Х11](image/14.png){#fig-014 width=70%}

## Настройка соединения X11 для суперпользователя

При попытке запуска приложения из-под суперпользователя возникает ошибка: `X11 connection rejected because of wrong authentication`. Ошибка возникает из-за того, что X-соединение выполняется от имени пользователя mininet, а приложение запускается от имени пользователя root с использованием sudo. Для исправления этой ситуации необходимо заполнить файл полномочий /root/.Xauthority, используя утилиту xauth. Скопируем значение куки (MIT magic cookie)1 пользователя mininet в файл для пользователя root ([рис. @fig-015]).

![Настройка соединения X11 для суперпользователя](image/15.png){#fig-015 width=70%}

## Основы работы в Mininet

Для запуска минимальной топологии введем в командной строке ([рис. @fig-016]): `sudo mn`.
Эта команда запускает Mininet с минимальной топологией, состоящей из коммутатора, подключённого к двум хостам. Для отображения списка команд интерфейса командной строки Mininet и примеров их использования введем команду в интерфейсе командной строки Mininet: `help`.

![Работа с Mininet с помощью командной строки](image/16.png){#fig-016 width=70%}

Для отображения доступных узлов введем: `nodes`. Вывод этой команды показывает, что есть два хоста (хост h1 и хост h2) и коммутатор (s1).

Иногда бывает полезно отобразить связи между устройствами в Mininet, чтобы понять топологию. Введем команду net в интерфейсе командной строки Mininet, чтобы просмотреть доступные линки: `net`.

Вывод этой команды показывает:
- Хост h1 подключён через свой сетевой интерфейс h1-eth0 к коммутатору на интерфейсе s1-eth1.
- Хост h2 подключён через свой сетевой интерфейс h2-eth0 к коммутатору на интерфейсе s1-eth2.
- Коммутатор s1:
  - имеет петлевой интерфейс lo.
  - подключается к h1-eth0 через интерфейс s1-eth1.
  - подключается к h2-eth0 через интерфейс s1-eth2.

Mininet позволяет выполнять команды на конкретном устройстве. Чтобы выполнить команду для определенного узла, необходимо сначала указать устройство, а затем команду, например: `h1 ifconfig`.

Эта запись выполняет команду ifconfig на хосте h1 и показывает интерфейсы хоста h1 — хост h1 имеет интерфейс h1-eth0, настроенный с IP-адресом 10.0.0.1, и другой интерфейс lo, настроенный с IP-адресом 127.0.0.1.

Посмотрим конфигурацию всех узлов ([рис. @fig-017]), ([рис. @fig-018]).

![Работа с Mininet с помощью командной строки](image/17.png){#fig-017 width=70%}

![Работа с Mininet с помощью командной строки](image/18.png){#fig-018 width=70%}

По умолчанию узлам h1 и h2 назначаются IP-адреса 10.0.0.1/8 и 10.0.0.2/8 соответственно. Чтобы проверить связь между ними, используем команду `ping`. Команда `ping` работает, отправляя сообщения эхо-запроса протокола управляющих сообщений Интернета (ICMP) на удалённый компьютер и ожидая ответа. Например, команда `h1 ping 10.0.0.2` проверяет соединение между хостами h1 и h2 ([рис. @fig-019]).

![Проверка связности хостов](image/19.png){#fig-019 width=70%}

## Построение и эмуляция сети в Mininet с использованием графического интерфейса

В терминале виртуальной машины mininet запустим MiniEdit: `sudo ~/mininet/mininet/examples/miniedit.py`.

Основные кнопки:
- Select: позволяет выбирать/перемещать устройства. Нажатие Del на клавиатуре после выбора устройства удаляет его из топологии.
- Host: позволяет добавить новый хост в топологию. После нажатия этой кнопки щелкните в любом месте пустого холста, чтобы вставить новый хост.
- Switch: позволяет добавить в топологию новый коммутатор. После нажатия этой кнопки щёлкните в любом месте пустого холста, чтобы вставить переключатель.
- Link: соединяет устройства в топологии. После нажатия этой кнопки щелкните устройство и перетащите его на второе устройство, с которым необходимо установить связь.
- Run: запускает эмуляцию. После проектирования и настройки топологии нажмите кнопку запуска.
- Stop: останавливает эмуляцию.

Добавим два хоста и один коммутатор, соединим хосты с коммутатором ([рис. @fig-020]).

![Добавление хостов и коммутатора](image/20.png){#fig-020 width=70%}

Настроим IP-адреса на хостах h1 и h2. Для этого удерживая правую кнопку мыши на устройстве выберем свойства. Для хоста h1 укажем IP-адрес `10.0.0.1/8`, а для хоста h2 — `10.0.0.2/8` ([рис. @fig-021]).

![Настройка IP-адресов](image/21.png){#fig-021 width=70%}

Перед проверкой соединения между хостом h1 и хостом h2 необходимо запустить эмуляцию. Для запуска эмуляции нажмем кнопку Run. После начала эмуляции кнопки панели MiniEdit станут серыми, указывая на то, что в настоящее время они отключены.

Откроем терминал на хосте h1, удерживая правую кнопку мыши на хосте h1 и выбрав Terminal. Это действие позволит выполнять команды на хосте h1. Откроем терминал на хосте h2. На терминале хоста h1 введем команду ifconfig, чтобы отобразить назначенные ему IP-адреса. Интерфейс h1-eth0 на хосте h1 настроен с IP-адресом 10.0.0.1 и маской подсети 255.0.0.0. Повторим эти действия на хосте h2. Его интерфейс h2-eth0 настроен с IP-адресом 10.0.0.2 и маской подсети 255.0.0.0 ([рис. @fig-022]).

![Проверка IP-адресов](image/22.png){#fig-022 width=70%}

Проверим соединение между хостами, введя в терминале хоста h1 команду `ping 10.0.0.2`. Для остановки теста нажмем `Ctrl + c`. Остановим эмуляцию, нажав кнопку Stop ([рис. @fig-023]).

![Проверка соединения между хостами](image/23.png){#fig-023 width=70%}

Ранее IP-адреса узлам h1 и h2 были назначены вручную. В качестве альтернативы можно полагаться на Mininet для автоматического назначения IP-адресов.

Удалим назначенный вручную IP-адрес с хостов h1 и h2. В MiniEdit нажмем Edit Preferences . По умолчанию в поле базовые значения IP-адресов (IP Base) установлено 10.0.0.0/8. Изменим это значение на 15.0.0.0/8 ([рис. @fig-024]).

![Смена базового IP-адреса](image/24.png){#fig-024 width=70%}

Запустим эмуляцию, нажав кнопку Run. Откроем терминал на хосте h1, удерживая правую кнопку мыши на хосте
h1 и выбрав Terminal. Чтобы отобразить IP-адреса, назначенные хосту h1, введем команду `ifconfig`. Интерфейс h1-eth0 на узле h1 теперь имеет IP-адрес 15.0.0.1 и маску подсети 255.0.0.0 ([рис. @fig-025]).

![Просмотр IP-адреса на h1](image/25.png){#fig-025 width=70%}

Проверим IP-адрес, назначенный хосту h2. Соответствующий интерфейс h2-eth0 на хосте h2 имеет IP-адрес 15.0.0.2
и маску подсети 255.0.0.0 ([рис. @fig-026]).

![Просмотр IP-адреса на h2](image/26.png){#fig-026 width=70%}

Остановим эмуляцию, нажав кнопку Stop.

В домашнем каталоге виртуальной машины mininet создадим каталог для работы с проектами mininet: `mkdir ~/work`. Для сохранения топологии сети в файл нажмем в MiniEdit File Save. Укажем имя для топологии и сохраним на своём компьютере. После сохранения проекта поменяем права доступа к файлам в каталоге проекта: `sudo chown -R mininet:mininet ~/work`. Для загрузки топологии в MiniEdit нажмем File Open ([рис. @fig-027]).

![Сохранение топологии](image/27.png){#fig-027 width=70%}

Завершим соединение с виртуальной машиной mininet и выключим её.

# Выводы

В результате выполнения данной лабораторной работы я развёрнула mininet в системе виртуализации VirtualBox, а также ознакомилась с основными командами для работы с Mininet через командную строку и через графический интерфейс.

# Список литературы{.unnumbered}

::: {#refs}
:::